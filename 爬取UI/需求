开发一个功能完整的油猴(Tampermonkey)脚本，实现网页元素的可视化选择、代码提取与实时编辑功能。该脚本面向前端开发者、网页设计师、UI/UX研究人员及内容编辑，旨在提高网页元素分析与复用的开发效率。

### 核心功能需求

#### 1. 元素选择功能
- 在脚本控制面板中添加"选择元素"按钮，点击后激活元素选择模式
- 选择模式下禁止原网站所有点击交互，防止误操作
- 实现鼠标悬停高亮效果：为当前悬停元素添加半透明覆盖层及边框高亮
- 点击选中目标元素后自动退出选择模式，并触发元素分析流程
- 高亮样式需清晰可辨，同时不影响元素原始视觉效果

#### 2. 元素信息爬取与处理
- 完整爬取选中元素的HTML结构，包括所有子元素层级关系
- 智能提取并处理CSS样式：
  - 整合内联样式、嵌入样式和外部样式表中的所有最终生效样式
  - 去除未生效的冗余样式代码，不添加无关属性（如family等）
  - 保留CSS嵌套关系，确保样式层级结构清晰
  - 清空原始class属性，生成新的唯一class名，实现样式隔离，确保生成的html不被原网站css影响
- 提取元素包含的文本内容及所有资源引用（图片、视频等）
- 过滤对样式和显示无影响的冗余属性，仅保留必要结构信息

#### 3. 弹窗界面实现
- **布局结构**：
  - 左侧：元素预览区域，实时显示选中元素的视觉效果
  - 右侧：代码编辑区域，包含HTML和CSS两个标签页切换
  - 底部：操作按钮栏，包含"一键复制"功能按钮
- **预览区域**：
  - 确保预览效果与原网页元素视觉一致
  - 支持宽度调整，适应不同尺寸元素预览需求
  - 实现样式隔离，防止预览区与弹窗样式冲突
- **代码编辑区域**：
  - HTML标签页：显示格式化后的选中元素HTML代码
  - CSS标签页：显示提取并优化后的CSS样式代码
  - 支持语法高亮显示，采用专业编辑器配色方案
  - 提供基本代码格式化功能（缩进、换行等）

#### 4. 交互功能实现
- **实时响应**：代码编辑区域内容修改后，预览区域需实时更新显示效果
- **窗口控制**：
  - 支持弹窗拖拽移动（通过标题栏）
  - 支持调整窗口大小（通过右下角调整柄）
  - 提供最小化功能（仅保留标题栏）
  - 提供关闭按钮，完全退出当前编辑会话
- **操作按钮**：
  - 底部"一键复制"按钮：复制当前编辑的HTML和CSS代码
  - 复制成功后提供明确的视觉反馈

### 技术实现要求
- 确保在主流浏览器（Chrome、Firefox、Edge等）及主流网站上稳定工作
- CSS处理需精准识别并提取最终生效样式，避免冗余代码
- 代码编辑区域需实现高性能语法高亮，支持常见代码编辑操作
- 预览区域与代码编辑区域的同步更新需流畅无明显延迟
- 实现深色主题UI设计，代码编辑区采用专业编辑器配色方案
- 弹窗界面需响应式设计，适应不同屏幕尺寸

### 质量标准
- 元素选择准确率达99%以上，无选择不到或误选情况
- CSS样式提取完整度达95%以上，确保预览效果与原网页一致
- 代码格式化清晰易读，符合行业标准规范
- 界面交互流畅，无卡顿或明显延迟（响应时间<100ms）
- 样式隔离彻底，无CSS冲突问题
- 操作提示文案简洁专业，符合技术用户使用习惯

### 用户体验要求
- 整体设计简洁直观，符合技术工具的专业定位
- 关键操作提供明确的视觉反馈
- 支持键盘快捷键操作，提升专业用户效率
- 错误处理机制完善，提供清晰的错误提示和恢复方案
- 弹窗大小和位置记忆功能，提升重复使用体验

该脚本应成为网页开发者日常工作中的实用工具，通过简化元素分析与代码提取流程，帮助用户快速复用和学习优秀网页设计实现。


